<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ELIGIWISE – Manage Bank / NBFC Policies</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
}

.container {
  max-width: 1200px;
  margin: 20px auto;
  background: #ffffff;
  padding: 20px;
  border-radius: 10px;
}

h1 {
  text-align: center;
  color: #044aa3;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 20px;
}

th, td {
  border: 1px solid #ccc;
  padding: 8px;
  text-align: center;
}

th {
  background: #044aa3;
  color: #fff;
  font-weight: bold;
}

button {
  padding: 6px 12px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-weight: bold;
}

.btn-edit {
  background: #f0ad4e;
  color: #fff;
}

.btn-delete {
  background: #d9534f;
  color: #fff;
}

.btn-save {
  background: #5cb85c;
  color: #fff;
}

input {
  width: 100%;
  padding: 6px;
}
</style>
</head>

<body>

<div class="container">
  <h1>ELIGIWISE – Manage Bank / NBFC Policies</h1>

  <table>
    <thead>
      <tr>
        <th>Bank / NBFC Name</th>
        <th>Loan Amount (L)</th>
        <th>CIBIL</th>
        <th>ABB (L)</th>
        <th>GST</th>
        <th>ITR</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="policyTable"></tbody>
  </table>
</div>

<script>
let policies = JSON.parse(localStorage.getItem("eligiwisePolicies")) || [];
let editIndex = -1;

function renderPolicies() {
  const tbody = document.getElementById("policyTable");
  tbody.innerHTML = "";

  if (policies.length === 0) {
    tbody.innerHTML = `
      <tr>
        <td colspan="7">No Bank / NBFC Policies Found</td>
      </tr>`;
    return;
  }

  policies.forEach((p, index) => {
    let row = document.createElement("tr");

    if (editIndex === index) {
      row.innerHTML = `
        <td><input id="bankName" value="${p.bankName || ""}"></td>
        <td><input id="loanAmount" value="${p.loanAmount || ""}"></td>
        <td><input id="cibil" value="${p.cibil || ""}"></td>
        <td><input id="abb" value="${p.abb || ""}"></td>
        <td><input id="gst" value="${p.gst || ""}"></td>
        <td><input id="itr" value="${p.itr || ""}"></td>
        <td>
          <button class="btn-save" onclick="savePolicy(${index})">Save</button>
        </td>
      `;
    } else {
      row.innerHTML = `
        <td>${p.bankName || "-"}</td>
        <td>${p.loanAmount || "-"}</td>
        <td>${p.cibil || "-"}</td>
        <td>${p.abb || "-"}</td>
        <td>${p.gst || "-"}</td>
        <td>${p.itr || "-"}</td>
        <td>
          <button class="btn-edit" onclick="editPolicy(${index})">Edit</button>
          <button class="btn-delete" onclick="deletePolicy(${index})">Delete</button>
        </td>
      `;
    }

    tbody.appendChild(row);
  });
}

function editPolicy(index) {
  editIndex = index;
  renderPolicies();
}

function savePolicy(index) {
  policies[index].bankName = document.getElementById("bankName").value;
  policies[index].loanAmount = document.getElementById("loanAmount").value;
  policies[index].cibil = document.getElementById("cibil").value;
  policies[index].abb = document.getElementById("abb").value;
  policies[index].gst = document.getElementById("gst").value;
  policies[index].itr = document.getElementById("itr").value;

  localStorage.setItem("eligiwisePolicies", JSON.stringify(policies));
  editIndex = -1;
  alert("✅ Policy updated successfully");
  renderPolicies();
}

function deletePolicy(index) {
  if (!confirm("Are you sure you want to delete this bank / NBFC policy?")) return;
  policies.splice(index, 1);
  localStorage.setItem("eligiwisePolicies", JSON.stringify(policies));
  renderPolicies();
}

renderPolicies();
</script>

</body>
</html>
