<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ELIGIWISE â€“ Bank / NBFC Policy Admin</title>

<style>
  <script>
if (localStorage.getItem("loggedInRole") !== "admin") {
  alert("Admin login required");
  location.href = "login.html";
}
</script>

body { font-family: Arial, sans-serif; background:#f4f6f8; }
.container { max-width:1300px; margin:20px auto; background:#fff; padding:20px; border-radius:10px; }

h1 { text-align:center; color:#0A4EA3; }

.section {
  background:#0A4EA3;
  color:#fff;
  padding:10px;
  margin-top:25px;
  font-weight:bold;
}

label { font-weight:bold; display:block; margin-top:10px; }
input, select {
  width:100%;
  padding:8px;
  margin-top:5px;
}

.grid {
  display:grid;
  grid-template-columns: repeat(3, 1fr);
  gap:15px;
}

.grid-2 {
  display:grid;
  grid-template-columns: repeat(2, 1fr);
  gap:15px;
}

button {
  margin-top:15px;
  padding:10px 15px;
  background:#0A4EA3;
  color:#fff;
  border:none;
  border-radius:5px;
  cursor:pointer;
}

button.red { background:#c0392b; }
button.green { background:#27ae60; }

.program-row {
  display:grid;
  grid-template-columns: 1fr 1fr auto;
  gap:10px;
  margin-top:8px;
}

.program-row button {
  background:#c0392b;
}

table {
  width:100%;
  border-collapse:collapse;
  margin-top:20px;
}

th, td {
  border:1px solid #ccc;
  padding:8px;
  text-align:center;
}

th {
  background:#0A4EA3;
  color:#fff;
}
</style>
</head>

<body>
<div class="container">

<h1>ELIGIWISE â€“ Bank / NBFC Policy Admin</h1>

<label>Bank / NBFC Name</label>
<input id="bankName" placeholder="Ex: HDFC, Tata Capital">

<!-- ================= SECTION A ================= -->
<div class="section">SECTION A â€“ BASIC PRODUCT DETAILS</div>

<div class="grid">
  <div>
    <label>Product Type</label>
    <select id="productType">
      <option>Small Ticket</option>
      <option>Big Ticket</option>
    </select>
  </div>
  <div>
    <label>Loan Type</label>
    <select id="loanType">
      <option>Term Loan</option>
      <option>OD</option>
    </select>
  </div>
</div>

<div class="grid">
  <div><label>Loan Amount Min (Lakhs)</label><input type="number" id="loanMin"></div>
  <div><label>Loan Amount Max (Lakhs)</label><input type="number" id="loanMax"></div>
  <div><label>Tenure Min</label><input type="number" id="tenureMin"></div>
  <div><label>Tenure Max</label><input type="number" id="tenureMax"></div>
  <div><label>ROI Min (%)</label><input type="number" step="0.01" id="roiMin"></div>
  <div><label>ROI Max (%)</label><input type="number" step="0.01" id="roiMax"></div>
  <div><label>PF Min (%)</label><input type="number" step="0.01" id="pfMin"></div>
  <div><label>PF Max (%)</label><input type="number" step="0.01" id="pfMax"></div>
</div>

<!-- ================= SECTION B ================= -->
<div class="section">SECTION B â€“ APPLICANT & CO-APPLICANT</div>

<div class="grid">
  <div><label>Applicant Age Min</label><input type="number" id="appAgeMin"></div>
  <div><label>Applicant Age Max</label><input type="number" id="appAgeMax"></div>
  <div>
    <label>Co-Applicant Mandatory</label>
    <select id="coApplicantMandatory">
      <option>No</option>
      <option>Yes</option>
    </select>
  </div>
  <div><label>Co-Applicant Age Min</label><input type="number" id="coAgeMin"></div>
  <div><label>Co-Applicant Age Max</label><input type="number" id="coAgeMax"></div>
</div>

<div class="grid-2">
  <div>
    <label>Own House</label>
    <select id="ownHouse">
      <option>Yes</option>
      <option>No</option>
    </select>
  </div>
  <div>
    <label>Own House Geo Limit</label>
    <select id="ownHouseGeo">
      <option>Local</option>
      <option>Anywhere India</option>
    </select>
  </div>
</div>

<!-- ================= SECTION C ================= -->
<div class="section">SECTION C â€“ BUSINESS & BANKING</div>

<label>Banking Type</label>
<select id="bankingType">
  <option>All</option>
  <option>CA</option>
  <option>SA</option>
  <option>OD</option>
  <option>CA+OD</option>
  <option>SA+CA</option>
</select>

<div class="grid-2">
  <div>
    <label>ITR Required</label>
    <select id="itrRequired">
      <option>No</option>
      <option>Yes</option>
    </select>
  </div>
  <div>
    <label>GST Required</label>
    <select id="gstRequired">
      <option>No</option>
      <option>Yes</option>
    </select>
  </div>
</div>

<label>Bank / NBFC Geo Limit (KM)</label>
<input type="number" id="geoLimit">

<!-- ================= SECTION D ================= -->
<div class="section">SECTION D â€“ CREDIT & OBLIGATIONS</div>

<div class="grid">
  <div><label>CIBIL Min</label><input type="number" id="cibilMin"></div>
  <div><label>CIBIL Max</label><input type="number" id="cibilMax"></div>
  <div><label>Active Loans Min</label><input type="number" id="activeLoansMin"></div>
  <div><label>Active Loans Max</label><input type="number" id="activeLoansMax"></div>
</div>

<div class="grid">
  <div><label>Loans in Last 6 Months (Count)</label><input type="number" id="loan6Count"></div>
  <div><label>Loan Amount Last 6 Months</label><input type="number" id="loan6Amount"></div>
  <div><label>Loans in Last 3 Months (Count)</label><input type="number" id="loan3Count"></div>
  <div><label>Loan Amount Last 3 Months</label><input type="number" id="loan3Amount"></div>
</div>

<div class="grid-2">
  <div><label>Enquiries Last 6 Months</label><input type="number" id="enq6"></div>
  <div><label>Enquiries Last 3 Months</label><input type="number" id="enq3"></div>
</div>

<!-- ================= SECTION E ================= -->
<div class="section">SECTION E â€“ PROGRAMS</div>

<label>ABB Programs (Minâ€“Max)</label>
<div id="abbPrograms"></div>
<button onclick="addProgram('abbPrograms')">+ Add ABB Program</button>

<label>ITR Programs (Minâ€“Max)</label>
<div id="itrPrograms"></div>
<button onclick="addProgram('itrPrograms')">+ Add ITR Program</button>

<label>GST Programs (Minâ€“Max)</label>
<div id="gstPrograms"></div>
<button onclick="addProgram('gstPrograms')">+ Add GST Program</button>

<label>Income / DSCR Programs (Minâ€“Max)</label>
<div id="incomePrograms"></div>
<button onclick="addProgram('incomePrograms')">+ Add Income / DSCR Program</button>

<!-- ================= SECTION F ================= -->
<div class="section">SECTION F â€“ CUSTOM / FUTURE PARAMETERS</div>
<div id="customFields"></div>
<button onclick="addCustom()">+ Add Custom Field</button>

<button class="green" onclick="savePolicy()">ðŸ’¾ Save / Update Policy</button>

<hr>

<h3>Saved Bank / NBFC Policies</h3>
<table id="policyTable">
<thead>
<tr>
  <th>Bank</th>
  <th>Product</th>
  <th>Loan Minâ€“Max</th>
  <th>Action</th>
</tr>
</thead>
<tbody></tbody>
</table>

</div>

<script>
let editIndex = null;

function addProgram(id) {
  const div = document.createElement("div");
  div.className = "program-row";
  div.innerHTML = `
    <input placeholder="Min">
    <input placeholder="Max">
    <button onclick="this.parentNode.remove()">X</button>`;
  document.getElementById(id).appendChild(div);
}

function addCustom() {
  const div = document.createElement("div");
  div.className = "program-row";
  div.innerHTML = `
    <input placeholder="Field Name">
    <input placeholder="Value">
    <button onclick="this.parentNode.remove()">X</button>`;
  document.getElementById("customFields").appendChild(div);
}

function collectPrograms(id) {
  return [...document.getElementById(id).children].map(r => ({
    min: Number(r.children[0].value),
    max: Number(r.children[1].value)
  }));
}

function savePolicy() {
  const policy = {
    bankName: bankName.value,
    productType: productType.value,
    loanType: loanType.value,
    loanMin: loanMin.value,
    loanMax: loanMax.value,
    tenureMin: tenureMin.value,
    tenureMax: tenureMax.value,
    roiMin: roiMin.value,
    roiMax: roiMax.value,
    pfMin: pfMin.value,
    pfMax: pfMax.value,
    appAgeMin: appAgeMin.value,
    appAgeMax: appAgeMax.value,
    coApplicantMandatory: coApplicantMandatory.value,
    coAgeMin: coAgeMin.value,
    coAgeMax: coAgeMax.value,
    ownHouse: ownHouse.value,
    ownHouseGeo: ownHouseGeo.value,
    bankingType: bankingType.value,
    itrRequired: itrRequired.value,
    gstRequired: gstRequired.value,
    geoLimit: geoLimit.value,
    cibilMin: cibilMin.value,
    cibilMax: cibilMax.value,
    activeLoansMin: activeLoansMin.value,
    activeLoansMax: activeLoansMax.value,
    loan6Count: loan6Count.value,
    loan6Amount: loan6Amount.value,
    loan3Count: loan3Count.value,
    loan3Amount: loan3Amount.value,
    enq6: enq6.value,
    enq3: enq3.value,
    abbPrograms: collectPrograms("abbPrograms"),
    itrPrograms: collectPrograms("itrPrograms"),
    gstPrograms: collectPrograms("gstPrograms"),
    incomePrograms: collectPrograms("incomePrograms"),
    custom: [...customFields.children].map(r => ({ field:r.children[0].value, value:r.children[1].value }))
  };

  let data = JSON.parse(localStorage.getItem("eligiwisePolicies")) || [];
  if (editIndex !== null) data[editIndex] = policy;
  else data.push(policy);

  localStorage.setItem("eligiwisePolicies", JSON.stringify(data));
  alert("Policy saved successfully");
  loadPolicies();
}

function loadPolicies() {
  const tbody = policyTable.querySelector("tbody");
  tbody.innerHTML = "";
  const data = JSON.parse(localStorage.getItem("eligiwisePolicies")) || [];
  data.forEach((p, i) => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${p.bankName}</td>
      <td>${p.productType}</td>
      <td>${p.loanMin}-${p.loanMax}</td>
      <td>
        <button onclick="editPolicy(${i})">Edit</button>
        <button class="red" onclick="deletePolicy(${i})">Delete</button>
      </td>`;
    tbody.appendChild(tr);
  });
}

function editPolicy(i) {
  const p = JSON.parse(localStorage.getItem("eligiwisePolicies"))[i];
  editIndex = i;
  Object.keys(p).forEach(k => {
    if (document.getElementById(k)) document.getElementById(k).value = p[k];
  });
  alert("Edit mode enabled. Update and Save.");
}

function deletePolicy(i) {
  if (!confirm("Delete this policy?")) return;
  let data = JSON.parse(localStorage.getItem("eligiwisePolicies"));
  data.splice(i,1);
  localStorage.setItem("eligiwisePolicies", JSON.stringify(data));
  loadPolicies();
}

loadPolicies();
  if (localStorage.getItem("eligiwiseRole") !== "admin") {
  alert("Admin login required");
  location.href = "login.html";
}

</script>

</body>
</html>
<button onclick="logout()">Logout</button>

<script>
function logout() {
  localStorage.clear();
  location.href = "login.html";
}
</script>



